/*! BingMapFFDraw - v0.0.1 - 2013-06-12
* https://github.com/dannyrscott/BingMapFreeFormDraw
* Copyright (c) 2013 Danny Scott; Licensed MIT */
(function(n){"use strict";var t=function(n){var t,e,o=n,i=Microsoft.Maps,s=new i.EntityCollection,a=new i.Polyline,r=[],c=new i.Polygon,u=!1;o.entities.push(s),s.push(a),s.push(c);var v=function(n){n=n||{};var s=n.onDrawEnd||function(){};u||(u=!0,t=i.Events.addThrottledHandler(o,"mousemove",function(n){r=a.getLocations()||[];var t,e=new i.Point(n.getX(),n.getY());try{t=n.target.tryPixelToLocation(e)}catch(o){t=!1}t&&(r.push(t),a.setLocations(r))},100),e=i.Events.addHandler(o,"click",function(){l(s),i.Events.removeHandler(e)}))},l=function(n){n=n||function(){},i.Events.removeHandler(t);var e=a.getLocations();e.length&&e.push(e[0]),a.setLocations([]),c.setLocations(e),u=!1,n()};this.enterDrawingMode=function(n){var t=i.Events.addHandler(o,"click",function(){i.Events.removeHandler(t),v(n)})}};n.BingDrawFF=t})("object"==typeof exports&&exports||this);